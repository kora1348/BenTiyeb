<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Tableau Crypto Long & Short (Futures)</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }

    table {
      border-collapse: collapse;
      width: 100%;
      max-width: 900px;
    }

    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: right;
    }

    th:first-child,
    td:first-child {
      text-align: left;
    }

    th {
      background-color: #f5f5f5;
    }

    .long-price {
      color: green;
      font-weight: bold;
    }

    .short-price {
      color: red;
      font-weight: bold;
    }

    .error {
      color: red;
      font-size: 0.85rem;
    }
  </style>
</head>
<body>
  <h2>Futures USDT-M - Prix actuels & niveaux Long (-0.50%) / Short (+0.50%)</h2>

  <table id="pricesTable">
    <thead>
      <tr>
        <th>Symbole</th>
        <th>Prix actuel</th>
        <th>Long (-0.50%)</th>
        <th>Short (+0.50%)</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <p id="errorMsg" class="error"></p>

  <script>
    const symbols = [
      "AEVOUSDT","ARPAUSDT","AXLUSDT","DIAUSDT","EGLDUSDT","IDUSDT","RONINUSDT","WLDUSDT",
      "1000SATSUSDT","1000LUNCUSDT","ANKRUSDT","DENTUSDT","ENJUSDT","NXPCUSDT"
    ];

    // üî• Endpoint FUTURES (USDT-M), pas le spot !
    const API_URL = "https://fapi.binance.com/fapi/v1/ticker/price";

    async function loadPrices() {
      const tbody = document.querySelector("#pricesTable tbody");
      const errorMsg = document.getElementById("errorMsg");
      tbody.innerHTML = "";
      errorMsg.textContent = "";

      for (const symbol of symbols) {
        try {
          const response = await fetch(`${API_URL}?symbol=${symbol}`);
          if (!response.ok) throw new Error(`HTTP ${response.status}`);

          const data = await response.json();
          const price = parseFloat(data.price);
          if (isNaN(price)) throw new Error("Prix invalide re√ßu pour " + symbol);

          const longPrice = price * 0.995;  // -0.50%
          const shortPrice = price * 1.005; // +0.50%

          const tr = document.createElement("tr");

          const tdSymbol = document.createElement("td");
          tdSymbol.textContent = symbol;
          tr.appendChild(tdSymbol);

          const tdCurrent = document.createElement("td");
          tdCurrent.textContent = price.toFixed(10);
          tr.appendChild(tdCurrent);

          const tdLong = document.createElement("td");
          tdLong.textContent = longPrice.toFixed(10);
          tdLong.classList.add("long-price");
          tr.appendChild(tdLong);

          const tdShort = document.createElement("td");
          tdShort.textContent = shortPrice.toFixed(10);
          tdShort.classList.add("short-price");
          tr.appendChild(tdShort);

          tbody.appendChild(tr);
        } catch (err) {
          console.error("Erreur pour", symbol, err);

          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${symbol}</td>
            <td colspan="3" style="text-align:center; color:red;">Erreur r√©cup√©ration prix</td>
          `;
          tbody.appendChild(tr);

          errorMsg.textContent = "Certaines donn√©es n'ont pas pu √™tre charg√©es (voir console).";
        }
      }
    }

    loadPrices();
    // setInterval(loadPrices, 15000); // Pour rafra√Æchir toutes les 15 secondes
  </script>
</body>
</html>
