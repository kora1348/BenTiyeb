<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Automation Scalping Binance (5x Levier)</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        #container { max-width: 800px; margin: 0 auto; }
        #logs { height: 300px; overflow-y: scroll; border: 1px solid #ccc; padding: 10px; margin-top: 20px; }
        .profit { color: green; }
        .loss { color: red; }
    </style>
</head>
<body>
    <div id="container">
        <h1>Automation Scalping Binance (5x Levier)</h1>
        <p><strong>Stratégie :</strong> Scalping avec levier 5x sur ETH/USDC et BTC/USDT</p>
        
        <div>
            <h3>Paramètres</h3>
            <label>Paire de trading : </label>
            <select id="pair">
                <option value="ETHUSDC">ETH/USDC</option>
                <option value="BTCUSDT">BTC/USDT</option>
            </select><br><br>
            
            <label>Montant à risquer (USDC/USDT) : </label>
            <input type="number" id="amount" value="100"><br><br>
            
            <label>Take Profit (%) : </label>
            <input type="number" id="takeProfit" value="0.5" step="0.1"><br><br>
            
            <label>Stop Loss (%) : </label>
            <input type="number" id="stopLoss" value="0.3" step="0.1"><br><br>
            
            <button id="startBtn">Démarrer le Bot</button>
            <button id="stopBtn" disabled>Arrêter le Bot</button>
        </div>
        
        <div id="logs"></div>
    </div>

    <script>
        // Variables globales
        let tradingActive = false;
        let currentPosition = null;
        let binanceSocket = null;
        
        // Éléments DOM
        const pairSelect = document.getElementById("pair");
        const amountInput = document.getElementById("amount");
        const takeProfitInput = document.getElementById("takeProfit");
        const stopLossInput = document.getElementById("stopLoss");
        const startBtn = document.getElementById("startBtn");
        const stopBtn = document.getElementById("stopBtn");
        const logsDiv = document.getElementById("logs");
        
        // Binance API (simplifiée pour l'exemple)
        const BinanceApi = {
            // Remplacez par vos clés API Binance (nécessaire pour le trading réel)
            API_KEY: "VOTRE_CLE_API",
            SECRET_KEY: "VOTRE_SECRET_API",
            
            // Fonction fictive pour passer un ordre (à adapter avec l'API réelle)
            placeOrder: async function(symbol, side, quantity, isCrossMargin = true) {
                const logEntry = `[ORDRE] ${side} ${quantity} ${symbol} (levier: ${isCrossMargin ? "5x" : "1x"})`;
                addLog(logEntry);
                
                // Simulation d'un ordre réussi (dans un vrai script, utilisez fetch() vers l'API Binance)
                return { success: true, orderId: Date.now(), avgPrice: getCurrentPrice(symbol) };
            },
            
            // Fermer une position
            closePosition: async function(symbol, positionId) {
                const logEntry = `[FERMETURE] Position ${positionId} sur ${symbol}`;
                addLog(logEntry);
                return { success: true };
            }
        };
        
        // Simulation du prix actuel (remplacé par WebSocket en réel)
        function getCurrentPrice(symbol) {
            // Exemples de prix fictifs
            const prices = {
                "ETHUSDC": 3700 + Math.random() * 20,
                "BTCUSDT": 119000 + Math.random() * 500
            };
            return prices[symbol] || 0;
        }
        
        // Log des événements
        function addLog(message, isProfit = false) {
            const logEntry = document.createElement("div");
            logEntry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logEntry.className = isProfit ? "profit" : "";
            logsDiv.appendChild(logEntry);
            logsDiv.scrollTop = logsDiv.scrollHeight;
        }
        
        // Stratégie de scalping
        async function executeStrategy() {
            if (!tradingActive) return;
            
            const symbol = pairSelect.value;
            const amount = parseFloat(amountInput.value);
            const takeProfitPct = parseFloat(takeProfitInput.value) / 100;
            const stopLossPct = parseFloat(stopLossInput.value) / 100;
            
            // Pas de position ouverte → Ouvrir une position
            if (!currentPosition) {
                const currentPrice = getCurrentPrice(symbol);
                const quantity = (amount * 5) / currentPrice; // Levier 5x
                
                const order = await BinanceApi.placeOrder(
                    symbol, 
                    "BUY", 
                    quantity.toFixed(6), 
                    true // Marge croisée (levier)
                );
                
                if (order.success) {
                    currentPosition = {
                        symbol,
                        entryPrice: order.avgPrice,
                        quantity,
                        orderId: order.orderId,
                        takeProfit: order.avgPrice * (1 + takeProfitPct),
                        stopLoss: order.avgPrice * (1 - stopLossPct)
                    };
                    
                    addLog(`Position ouverte: ${quantity} ${symbol} à ${order.avgPrice}`);
                }
            } 
            // Position ouverte → Vérifier Take Profit / Stop Loss
            else {
                const currentPrice = getCurrentPrice(symbol);
                
                if (currentPrice >= currentPosition.takeProfit) {
                    const order = await BinanceApi.closePosition(symbol, currentPosition.orderId);
                    if (order.success) {
                        const profit = (currentPrice - currentPosition.entryPrice) * currentPosition.quantity;
                        addLog(`Take Profit atteint! Profit: ${profit.toFixed(2)}`, true);
                        currentPosition = null;
                    }
                } 
                else if (currentPrice <= currentPosition.stopLoss) {
                    const order = await BinanceApi.closePosition(symbol, currentPosition.orderId);
                    if (order.success) {
                        const loss = (currentPosition.entryPrice - currentPrice) * currentPosition.quantity;
                        addLog(`Stop Loss atteint! Perte: ${loss.toFixed(2)}`, false);
                        currentPosition = null;
                    }
                }
            }
            
            // Répéter la stratégie toutes les 5 secondes (ajustable)
            setTimeout(executeStrategy, 5000);
        }
        
        // Boutons
        startBtn.addEventListener("click", () => {
            tradingActive = true;
            startBtn.disabled = true;
            stopBtn.disabled = false;
            addLog("Démarrage du bot...");
            executeStrategy();
        });
        
        stopBtn.addEventListener("click", () => {
            tradingActive = false;
            startBtn.disabled = false;
            stopBtn.disabled = true;
            addLog("Bot arrêté.");
        });
    </script>
</body>
</html>